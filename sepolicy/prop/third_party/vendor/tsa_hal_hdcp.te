# ==============================================
# MTK Policy Rule
# ==============================================
# Policy File of HDCP HAL service
type tsa_hal_hdcp ,domain;
type tsa_hal_hdcp_exec, exec_type, vendor_file_type, file_type;

init_daemon_domain(tsa_hal_hdcp)

hal_server_domain(tsa_hal_hdcp, hal_tsa_hdcp)

vndbinder_use(tsa_hal_hdcp)

# Allow HDCP to access HDCP key folder
allow tsa_hal_hdcp mnt_vendor_file:dir { search getattr };
allow tsa_hal_hdcp persist_data_file:dir search;
allow tsa_hal_hdcp persist_data_file:file rw_file_perms;

# Allow HDCP to access codec FD
allow tsa_hal_hdcp mtk_hal_c2:fd use;

# Allow HDCP to access Trustzone
allow tsa_hal_hdcp mobicore_user_device:chr_file rw_file_perms;
allow tsa_hal_hdcp mobicore_vendor_file:file lock;
