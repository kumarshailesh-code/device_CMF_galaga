# ==============================================
# MTK Policy Rule
# ==============================================

# Date : WK14.34
# Operation : Migration
# Purpose :  For WIFI SANITY test to set FW path(STA/P2P/AP)
# Owner: TingTing Lei
allow netd wmtWifi_device:chr_file w_file_perms;

# Date : WK14.34
# Operation : Migration
# Purpose :  NA
# Owner: Changqing Sun
allow netd self:capability { fsetid setuid setgid };

# Date : WK14.34
# Operation : Migration
# Purpose: APP
allow netd platform_app:fd use;

# Date : WK14.37
# Operation : Migration
# Purpose :  PPPOE Test
# Owner : lina wang
allow netd ppp:process sigkill;

allow netd untrusted_app:fd use;

# Date : W17.31
# Operation : O migration
# Purpose : Allow ViLTE use udp_socket
allow netd vtservice:fd use;
allow netd vtservice:udp_socket { read write setopt getopt };

allow netd wo_ipsec:fd use;
allow netd wo_ipsec:tcp_socket { read write setopt getopt };
allow netd wo_ipsec:udp_socket { read write setopt getopt };

# MTK support app feature
get_prop(netd, vendor_mtk_app_prop)

allow netd bip_ap:fd use;
allow netd bip_ap:tcp_socket { read write setopt getopt };
allow netd bip_ap:udp_socket {read write setopt getopt};

# Date : W21.44
# Operation: ROI
# Purpose: Allow ROI stack socket operation
allow netd rcs_volte_stack:fd use;
allow netd rcs_volte_stack:tcp_socket { read write setopt getopt };
allow netd rcs_volte_stack:udp_socket { read write setopt getopt };

# Date : W22.58
# Operation: gnss_deamon EPO
# Purpose :  Allow gnss_deamon use tcp_socket for EPO
allow netd gnss_daemon:fd use;
allow netd gnss_daemon:tcp_socket { read write getopt setopt };

# Date : W22.53
# Operation: meta_tst daemon
# Purpose :  Allow meta_tst daemon use tcp_socket
allow netd meta_tst:fd use;
allow netd meta_tst:tcp_socket { read write getopt setopt };
