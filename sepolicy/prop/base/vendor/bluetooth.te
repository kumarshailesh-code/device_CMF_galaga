# ==============================================
# MTK Policy Rule
# ==============================================

# Device access
allow bluetooth stpbt_device:chr_file rw_file_perms;

# NVRAM access
allow bluetooth nvram_data_file:dir search;
allow bluetooth nvram_data_file:file rw_file_perms;
allow bluetooth nvram_data_file:lnk_file r_file_perms;
allow bluetooth nvdata_file:lnk_file r_file_perms;
allow bluetooth nvdata_file:dir search;
allow bluetooth nvdata_file:file rw_file_perms;

allow bluetooth block_device:dir search;

# Date : WK15.36
# Operation : Migration
# Purpose: Allow bluetooth to access surfaceflinger
allow bluetooth surfaceflinger:fifo_file rw_file_perms;

# Date:W17.07
# Operation : bt hal developing
# Purpose : bt hal interface permission
binder_call(bluetooth, mtk_hal_bluetooth)

allow bluetooth storage_stub_file:dir getattr;

# Date: 2018/02/02
# Major permission allow are in /system/sepoplicy/private/bluetooth.te
# Add dir create perms for bluetooth on /data/misc/bluetooth/logs
allow bluetooth bluetooth_logs_data_file:dir { create_dir_perms relabelto };
allow bluetooth bluetooth_logs_data_file:fifo_file create_file_perms;

# Date: 2019/09/19
allow bluetooth mtk_hal_bluetooth_audio_hwservice:hwservice_manager find;

# Date :  2020/06/11
# Operation : allow bt native process to access driver debug node and set kernel thread priority
# Purpose: allow bt native process to access driver debug node and set kernel thread priority
allow bluetooth proc_btdbg:file rw_file_perms;
allow bluetooth kernel:process setsched;

get_prop(bluetooth, vendor_mtk_bt_perf_prop)

# Date : 2021/09/07
# Operation : allow bluetooth to access mediametrics
# Purpose: This operation will block A2DP Sink playback
allow bluetooth mediametrics_service:service_manager find;

# Date : 2023/01/04
hal_client_domain(bluetooth, hal_mtk_audio)

get_prop(bluetooth, vendor_mtk_bt_connac3_prop)

