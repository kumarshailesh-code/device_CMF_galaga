# ==============================================
# MTK Policy Rule
# ==============================================

##########################
# Data files
#
/data/debuglogger(/.*)?        u:object_r:debuglog_data_file:s0
/data/ramdump(/.*)?            u:object_r:debuglog_data_file:s0
/data/system_de/mdfilter(/.*)? u:object_r:mddb_filter_data_file:s0
/data/vendor_de/meta           u:object_r:vendor_data_file:s0
/data/misc/bthci(/.*)?         u:object_r:debuglog_data_file:s0

##########################
# System files
#
/(system_ext|system/system_ext)/bin/em_svr               u:object_r:em_svr_exec:s0
/(system_ext|system/system_ext)/bin/lbs_dbg_ext          u:object_r:lbs_dbg_ext_exec:s0

# storagemanager daemon
# it is used to mount all storages in meta/factory mode
/system/bin/storagemanagerd u:object_r:vold_exec:s0

# MTK Bootanim
/system/bin/mtkbootanimation  u:object_r:mtkbootanimation_exec:s0
/system/bin/boot_logo_updater u:object_r:boot_logo_updater_exec:s0

# Date: 2020/08/17
# Operation: R migration
# Purpose: Add permission for pl path utilities for OTA
/(system|system/system_ext|system_ext)/bin/mtk_plpath_utils u:object_r:mtk_plpath_utils_exec:s0
/system/bin/create_pl_dev u:object_r:mtk_plpath_utils_exec:s0

# mediaserver 64 bit support
/(system_ext|system/system_ext)/bin/mediahelper    u:object_r:mediahelper_exec:s0

/(system_ext|system/system_ext)/bin/kpoc_charger u:object_r:kpoc_charger_exec:s0

# MTK Thermald
/(system_ext|system/system_ext)/bin/thermald u:object_r:thermald_exec:s0

# MTK VTService
/(system_ext|system/system_ext)/bin/vtservice u:object_r:vtservice_exec:s0

# MTK ATCI
/system/bin/atci_service_sys u:object_r:atci_service_sys_exec:s0

# MTK Postalgo
/system/bin/camerapostalgo u:object_r:camerapostalgo_exec:s0

# MTK AAL
/system/bin/aal u:object_r:aal_exec:s0

/(system_ext|system/system_ext)/bin/batterywarning  u:object_r:batterywarning_exec:s0
/(system_ext|system/system_ext)/bin/GoogleOtaBinder u:object_r:GoogleOtaBinder_exec:s0
/(system_ext|system/system_ext)/bin/mmp             u:object_r:mmp_exec:s0

# MTK Carrier express
/(system_ext|system/system_ext)/bin/usp_service     u:object_r:usp_service_exec:s0

# MTK TerService
/(system_ext|system/system_ext)/bin/terservice u:object_r:terservice_exec:s0

# MTK MAPI (Modem Diagnostic Public Interface)
/(system_ext|system/system_ext)/bin/mdi_redirector u:object_r:mdi_redirector_exec:s0

# MTK MDMI test tool (Modem Diagnostic Monitoring Interface)
/(system_ext|system/system_ext)/bin/mdmi_redirector u:object_r:mdmi_redirector_exec:s0

# resize userdata's filesystem size
/system/bin/resize.f2fs u:object_r:resize_exec:s0

# VSIM 3.0
/system/bin/osi u:object_r:osi_exec:s0

# MAGT Service
/(system|system/system_ext|system_ext)/bin/magt u:object_r:magt_exec:s0

##########################
# Devices
#
/dev/block/mntlblk(.*)? u:object_r:mtd_device:s0
/dev/block/mtd(.*)?     u:object_r:mtd_device:s0
/dev/mcupm(/.*)?        u:object_r:mcupm_device:s0
/dev/ubi_ctrl           u:object_r:mtd_device:s0
/dev/ubi[_0-9]*         u:object_r:mtd_device:s0

# MTK touchll hal
/dev/tll u:object_r:tll_device:s0

##########################
# Others
#
/eng u:object_r:rootfs:s0

##########################
# support system server domain do ioctl with framework-res
/system/framework/framework-res.apk u:object_r:system_mtk_pmb_file:s0


##########################
# support system server domain do ioctl with SetupWizard
/system/system_ext/priv-app/SetupWizard/SetupWizard.apk u:object_r:system_mtk_pmb_file:s0

##########################
# support system server domain do ioctl with EngineerMode
/system/priv-app/EngineerMode/EngineerMode.apk u:object_r:system_mtk_pmb_file:s0
