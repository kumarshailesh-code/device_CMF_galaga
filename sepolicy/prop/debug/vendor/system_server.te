# ==============================================
# MTK Policy Rule
# ==============================================

allow system_server aee_exp_data_file:file w_file_perms;

# Date:W17.22
# Operation : add aee_aed socket rule
# Purpose : type=1400 audit(0.0:134519): avc: denied { connectto }
#           for comm=4572726F722064756D703A20737973
#           path=00636F6D2E6D746B2E6165652E6165645F3634
#           scontext=u:r:system_server:s0 tcontext=u:r:crash_dump:s0
#           tclass=unix_stream_socket permissive=0
allow system_server crash_dump:unix_stream_socket connectto;

# Search /proc/proc_mtmon
allow system_server proc_mtmon:dir search;

# Date:2020/09/01
# Operation:R Migration
allow system_server proc_aed:dir search;

# Search /proc/iommu/debug
allow system_server proc_iommu_debug:dir search;

# Search /proc/dmaheap
allow system_server proc_dmaheap:dir search;

# Date:2022/10/12
# /data/core access for debug migration U0
allow system_server aee_core_data_file:dir r_dir_perms;

# Date:2023/03/15
# allow system server Search powerHal point
allow system_server proc_apusys_rv_debug:dir search;

# Date : 2023/02/16
# Purpose: check mbrain is enabled
get_prop(system_server, vendor_mtk_mbrain_prop)
