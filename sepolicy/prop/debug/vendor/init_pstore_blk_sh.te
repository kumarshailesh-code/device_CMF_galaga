# ==============================================
# MTK Policy Rule
# ==============================================

type init_pstore_blk_sh, domain;
type init_pstore_blk_sh_exec, exec_type, vendor_file_type, file_type;

init_daemon_domain(init_pstore_blk_sh)

allow init_pstore_blk_sh vendor_toolbox_exec:file rx_file_perms;
allow init_pstore_blk_sh self:capability sys_module;
allow init_pstore_blk_sh vendor_file:system module_load;
allow init_pstore_blk_sh kernel:key search;
allow init_pstore_blk_sh block_device:dir search;
allow init_pstore_blk_sh pstore_block_device:blk_file rw_file_perms_no_map;

# Date : WK22.32
# Purpose : modprobe need proc_modules
allow init_pstore_blk_sh proc_modules:file r_file_perms;
